

<div class = "row title-table"><div class = "col-md-12">
     
   <div class = "col-md-10">
      <p >Mis Reportes (<%=@reports.count%>)</p>
   </div>
    <div class = "col-md-2">
       <%= link_to 'Nuevo', new_report_path, class: "btn btn-primary"  if current_user.role == "SuperAdmin" || current_user.rol.report_crear %>
   </div>
   </div>
  
</div>
<% if action_name == "index"%>
<%= (link_to "filtros", misreports_path + "?filtros=true", class: "linka canf1") if !params[:commit]  %>
<%end%>
<div class="row busqueda" style = "display:none;">
   <div class="col-md-12">
   <%= form_tag(misreports_path, :method => "get", id: "search-form", class: "form-inline form1") do %>
<%= text_field_tag :search0, params[:search0], placeholder: "Fecha Desde",class: "form-control datepicker shi1 sh0" %><%= text_field_tag :search, params[:search], placeholder: "Fecha Hasta",class: "form-control datepicker1 shi1 sh00" %>
<script>
   $(function() {
   $.datepicker.regional['es'] = {
   closeText: 'Cerrar',
   prevText: '< Ant',
   nextText: 'Sig >',
   currentText: 'Hoy',
   monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
   monthNamesShort: ['Ene','Feb','Mar','Abr', 'May','Jun','Jul','Ago','Sep', 'Oct','Nov','Dic'],
   dayNames: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
   dayNamesShort: ['Dom','Lun','Mar','Mié','Juv','Vie','Sáb'],
   dayNamesMin: ['Do','Lu','Ma','Mi','Ju','Vi','Sá'],
   weekHeader: 'Sm',
   dateFormat: 'dd/mm/yy',
   firstDay: 1,
   isRTL: false,
   showMonthAfterYear: false,
   yearSuffix: ''
   };
   $.datepicker.setDefaults($.datepicker.regional['es']);
   $('.datepicker').datepicker({
     altField: "#actualDate",
     changeMonth: true,
     changeYear: true,
     dateFormat: 'mm-dd-yy'
   });
   $.datepicker.setDefaults($.datepicker.regional['es']);
   $('.datepicker1').datepicker({
     altField: "#actualDate",
     changeMonth: true,
     changeYear: true,
      dateFormat: 'mm-dd-yy'
   });
   
   });
   
   
</script>
<%=select_tag 'search2', options_for_select(get_sources.collect{ |u| [u.name, u.id, ] }),{:class => "form-control sh filter", include_blank: true , placeholder: "hola"}%>
<%=select_tag 'search3', options_for_select(get_employeds.collect{ |u| ["#{u.first_name} #{u.first_last_name}", u.id, ] }),{:class => "form-control sh1 filter", include_blank: true , placeholder: "hola"}%>
<%=select_tag 'search4', options_for_select(get_procesos.collect{ |u| [u.name, u.id, ] }),{:class => "form-control sh2 filter shi", include_blank: true , placeholder: "hola"}%>
<%= text_field_tag :search5, params[:search5], placeholder: " Descripcion", class: "form-control shi sh3" %>
<%= select_tag "search6", options_for_select(["","Abiertos", "Cerrados" ] ), {class: "form-control shi sh4 ", include_blank: true } %>
<%= submit_tag "Buscar", :class => "btn btn-primary submit-btn", style: "margin-left:10px;padding:3px 20px;" %>
<% end %>
   </div>
</div>

<div class = "row">
<% if action_name == "index"%>
<%= (link_to "Cancelar filtros", misreports_path, class: "linka canf") if (params[:commit] || params[:filtros])  %>

<%end%>

<hr>



<% @reports.each do |report| 
      %>


<%= link_to  report_path(report) do %>
<div class="row seg">

<div class="col-md-12">
<div class="col-md-3">
<strong>Creación:</strong> <%= get_date(report.created_at)%>
</div>
<div class="col-md-3">
 <strong>Codigo:</strong> <%=report.codigo%>
</div>
<div class="col-md-3">
<% employed = Employed.find(report.employed_id)%>
   <strong>Responsable:</strong> <button type="button" class="btn numerb" data-container="body" data-toggle="popover" data-placement="top" data-content="<p style='text-align:center;margin:0px;padding:0px;'><img src='<%= employed.avatare_url(:thumb) %>'></p><br><strong>Cargo:</strong> <%= employed.cargo.name %><br> <strong>Email:</strong> <%= employed.email%><br><strong>Cedula:</strong> <%= employed.document %>"><%= employed.first_name %> <%= employed.first_last_name %></button>
</div>

<div class="col-md-3 text-right">
<%if report.state == "Abierto"  %>
         <i style = "font-size:20px"  class="fa fa-unlock" aria-hidden="true"></i>
         <%else%>
         <i  style = "font-size:20px" class="fa fa-lock" aria-hidden="true"></i>
         <%end%>
</div>
  
</div>
<div class="col-md-12">

<div class="col-md-3">
 <strong>Fuente:</strong> <%=report.source.name%>
</div>
<div class="col-md-3">
 <strong>Costo:</strong> <%=report.costo%>
</div>

<div class="col-md-3">
  <strong>Compromiso:</strong> <%= get_date(report.f_compromiso)%>
</div>

  
</div>
<hr style = "    border: 0.5px solid #dedede !important;">
<div class="col-md-12">
<div class="col-md-11">
	<strong>Nombre de Actividad: </strong><%= report.name%>

</div>
  <div class="col-md-1 ball">
  <%if report.source.balon%>
	<%=  (image_tag "https://www.ecured.cu/images/thumb/7/7a/PELOTA_TENIS.jpg/260px-PELOTA_TENIS.jpg", style:"width:30px") if (@resp == "resp" && report.balon == "responsable")%> 
  <%=  (image_tag "https://www.ecured.cu/images/thumb/7/7a/PELOTA_TENIS.jpg/260px-PELOTA_TENIS.jpg", style:"width:30px") if (@resp == "asig" && report.balon == "asignador")%>
  <%end%> 
</div>
</div>
  
</div>
 <% end %>
<br>
 <% end %>

<style>
  .seg
  {
   
    padding: 10px;
    color: gray;
    
    border: 1px solid #cecece;
  font-size: 13px !important;
     -webkit-transition: box-shadow 0.3s; /* For Safari 3.1 to 6.0 */
    transition: box-shadow 0.3s;
  }
  .seg:hover
  {
  
    box-shadow: rgb(136, 136, 136) 0px 0px 8px 0px;
  }
</style>

<script>
	  $(document).on('turbolinks:load',function() {
   if ("<%=params[:filtros]%>" != "" ||  "<%=params[:commit]%>" != "")
   {
 $('.busqueda').show();
 $('.canf').show();
 $('.canf1').hide();

   }
   else
   {
    $('.busqueda').hide();
     $('.canf1').show();

   }

     

 });

      
   
</script>
<script>
   $(document).on('turbolinks:load',function() {
   
      
      
      
   
      $('.sh').chosen(
          {
      
            allow_single_deselect: true,
            no_results_text: 'No hay resultados',
            width: '150px',
            placeholder_text_single: "Fuente",
            placeholder_text_multiple: "Seleccione una varias opciones"
      
          });
   
      $('.sh4').chosen(
          {
      
            allow_single_deselect: true,
            no_results_text: 'No hay resultados',
            width: '150px',
            placeholder_text_single: "Estado",
            placeholder_text_multiple: "Seleccione una varias opciones"
      
          });
     
      
     
   
      $('.sh1').chosen(
          {
      
            allow_single_deselect: true,
            no_results_text: 'No hay resultados',
            width: '150px',
            placeholder_text_single: "Responsable",
            placeholder_text_multiple: "Seleccione una varias opciones"
      
          });
      
     
      
      $('.sh2').chosen(
          {
      
            allow_single_deselect: true,
            no_results_text: 'No hay resultados',
            width: '150px',
            placeholder_text_single: "Proceso",
            placeholder_text_multiple: "Seleccione una varias opciones"
      
          });
    $('.chosen-container span').addClass("shi") ;
     }); 
   $('.sh').val("<%=params[:search2]%>") ;
    $('.sh2').val("<%=params[:search4]%>") ;
      $('.sh3').val("<%=params[:search5]%>") ;
       $('.sh1').val("<%=params[:search3]%>") ;
      $('.sh4').val("<%=params[:search6]%>") ;
      $('.sh0').val("<%=params[:search0]%>") ;
      $('.sh00').val("<%=params[:search]%>") ;
      
     
      /*$('.filtrost').hide();
      if ("<%=params[:commit]%>" != "")
      {
      $('.filtrost').fadeIn();
      $('.filtros1').fadeOut();
      }
      
      $('.filtros1').click(function(){
      
      $('.filtrost').fadeIn();
      $('.filtros1').fadeOut();
      
      });*/
      
      
      
      
</script>
<style>
   .shi
   {
   height:  30px !important;
   color:gray !important;
   font-size: 10px !important;
   }
   .shi1
   {
   width: 60px;
   display: inline-block;
   height:  30px !important;
   color:gray !important;
   font-size: 10px !important;
   padding: 6px 2px;
   text-align: center;
   }
   .busqueda
   {
        display: block;
    padding: 10px;
    background: #e8e8e8;
   }
   .ball img
   {
   	width: 30px;
   }
</style>













